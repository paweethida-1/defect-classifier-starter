# Defect Classifier on Surface Images (ML Project)

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß **‡∏õ‡∏Å‡∏ï‡∏¥ (0)** ‡∏Å‡∏±‡∏ö **‡∏°‡∏µ defect (1)** ‡∏î‡πâ‡∏ß‡∏¢ Machine Learning + Image Processing  
‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (Python 3.10+)

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
```
defect-classifier-starter/
‚îú‚îÄ src/
‚îÇ  ‚îú‚îÄ features.py
‚îú‚îÄ data/              # (‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°) ‡∏à‡∏∞‡∏°‡∏µ images/ ‡πÅ‡∏•‡∏∞ labels.csv ‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô generate_dataset.py
‚îú‚îÄ models/            # ‡πÄ‡∏Å‡πá‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà train ‡πÅ‡∏•‡πâ‡∏ß (.pkl)
‚îú‚îÄ outputs/           # ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‡πÄ‡∏ä‡πà‡∏ô confusion_matrix.png, classification_report.txt
‚îú‚îÄ generate_dataset.py
‚îú‚îÄ train.py
‚îú‚îÄ evaluate.py
‚îú‚îÄ visualize_samples.py
‚îú‚îÄ requirements.txt
‚îî‚îÄ .gitignore
```
> ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `data/`, `models/`, `outputs/` ‡∏ñ‡∏π‡∏Å ignore ‡πÄ‡∏ß‡∏•‡∏≤ push ‡∏Ç‡∏∂‡πâ‡∏ô GitHub ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

---

## ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á (Setup)
```bash
# 1) ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Python env
python -m venv .venv
# Windows: .venv\Scripts\activate
# macOS/Linux:
source .venv/bin/activate

# 2) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ
pip install --upgrade pip
pip install -r requirements.txt
```

---

## ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Synthetic Dataset)
```bash
python generate_dataset.py --n 600 --size 100 --out data
```
‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ:
- `data/images/*.png`  : ‡∏£‡∏π‡∏õ grayscale 100x100 (‡∏õ‡∏Å‡∏ï‡∏¥/‡∏°‡∏µ defect)
- `data/labels.csv`    : ‡πÑ‡∏ü‡∏•‡πå label (0/1) ‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå

‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ:
- `--n`   ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (default: 400)
- `--size` ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° (default: 100)
- `--seed` ‡∏Ñ‡πà‡∏≤ random seed (default: 42)

---

## ‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• (Train)
```bash
python train.py --features hog+stats --model svm --test-size 0.2
```
- `--features` ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `hog`, `stats`, ‡∏´‡∏£‡∏∑‡∏≠ `hog+stats`  
- `--model`    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å `svm` ‡∏´‡∏£‡∏∑‡∏≠ `rf` (Random Forest)
- `--test-size` ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô test split (default: 0.2)

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
- `outputs/confusion_matrix.png`
- `outputs/classification_report.txt`
- ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà `models/model_<model>_<features>.pkl`
- ‡∏ï‡∏±‡∏ß‡πÅ‡∏¢‡∏Å‡∏™‡πÄ‡∏Å‡∏•/‡πÄ‡∏°‡∏ï‡∏≤‡∏î‡∏≤‡∏ï‡πâ‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (‡∏ú‡πà‡∏≤‡∏ô `joblib`)

---

## ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô/‡∏•‡∏≠‡∏á‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ (Evaluate / Predict)
1) ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ö‡∏ô test split ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ï‡∏≠‡∏ô‡πÄ‡∏ó‡∏£‡∏ô:
```bash
python evaluate.py --use-saved-test
```
> ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå `outputs/test_split.csv` ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≠‡∏ô train

2) ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡∏°‡∏µ labels ‡∏Å‡πá‡πÑ‡∏î‡πâ):
```bash
python evaluate.py --predict-dir some_folder_of_images
```

---

## ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ (Visualize)
```bash
python visualize_samples.py --k 12
```

---

## ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå
- **HOG (Histogram of Oriented Gradients)**: ‡∏à‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö/‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏ö‡∏†‡∏≤‡∏û ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏£‡∏≠‡∏¢‡∏Ç‡∏µ‡∏î/‡πÄ‡∏™‡πâ‡∏ô
- **Stats (‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô)**: mean, std, edge density (‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏ö‡∏†‡∏≤‡∏û), high‚Äëgradient ratio ‡∏Ø‡∏•‡∏Ø



---

# Defect Classifier on Surface Images (ML Project)

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß **‡∏õ‡∏Å‡∏ï‡∏¥ (0)** ‡∏Å‡∏±‡∏ö **‡∏°‡∏µ defect (1)** ‡∏î‡πâ‡∏ß‡∏¢ Machine Learning + Image Processing  
‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (Python 3.10+)

---

## üìÇ Example Output

| Sample Grid (‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Dataset) | Confusion Matrix (‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å) |
|--------------------------------------|--------------------------------|
| <img src="outputs/sample_grid.png" width="350"/> | <img src="outputs/confusion_matrix.png" width="350"/> |
| ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏õ‡∏Å‡∏ï‡∏¥/defect ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ train/test | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏•‡∏≤‡∏™ |

---

### üîπ Classification Report
‡πÑ‡∏ü‡∏•‡πå `outputs/classification_report.txt`  
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤:
